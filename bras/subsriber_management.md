# Subscriber management. Управление подписчиками.

### TheRouter поддерживает следующие функции и технологии, необходимые для управления подпичиками
и создания BRAS сервера.
 * L2/L3 connected subscribers
 * vlan per subsriber with ip unnumbered adresses
 * proxy arp
 * traffic shaping (Token bucket filter with extended burst value)
 * DHCP relay
 * redirect subsriber traffic based on multiple routing tables and PBR
 * radius/coa

## Варианты подключений подписчиков

### L2 connected subscribers

<img src="http://therouter.net/images/bras/l2_connected_subsc_overview.png">

Подписчики и раутер подключаются друг к другу через общий L2 широковещательный домен.
На раутере настраивается интерфейс, используемый для создания сессий подписчиков.
Этот интерфейс может использовать любой вариант инкапсуляции: untagged, dot1q, qinq.
В настройках интерфейса должен быть указан флаг l2_subs, разрешающий раутеру создание 
сессий подписчиков на этом интерфейсе. 

	vif add name v_subsc port 0 type qinq svid 2 cvid 121 flags l2_subs

Создание сессии подписчика инициируется входящим или исходящим 
неклассифицированным ip пакетом. Неклассифицированным пакетом считается пакет, ip адрес которого
(ip адрес назначения в случае исходящих пакетов или ip адрес источника для входящих пакетов)
не принадлежит ни одной из авторизованных сессий.

Для авторизации сессии используется radius протокол.
Запрос на авторизацию L2 subsriber ceccии включает следующие атрибуты:

todo

### L3 connected subscribers

<img src="http://therouter.net/images/bras/l3_connected_subsc_overview.png">

L2 трафик подписчиков терминируется на отдельном маршрутизаторе, который в свою очередь, 
подключается к the_router через любой доступный на нем интерфейс.
Этот интерфейс может использовать любой вариант инкапсуляции: untagged, dot1q, qinq.
В настройках интерфейса должен быть указан флаг l3_subs, разрешающий раутеру создание 
сессий подписчиков на этом интерфейсе.

	vif add name v21 port 0 type dot1q cvid 21 flags l3_subs

Создание сессии подписчика инициируется входящим или исходящим 
неклассифицированным ip пакетом. Неклассифицированным пакетом считается пакет, ip адрес которого
(ip адрес назначения в случае исходящих пакетов или ip адрес источника для входящих пакетов)
не принадлежит ни одной из авторизованных сессий.

Для авторизации сессии используется radius протокол.
Запрос на авторизацию L3 subsriber ceccии включает следующие атрибуты:

todo
